<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC 
"-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.spring.mapper.QnaMapper">

  <select id="getQnaList" resultType="com.spring.dto.Qna">
    SELECT * FROM qna ORDER BY parno DESC, plevel ASC
  </select>
<!-- 
  <select id="getRecentQnaList" resultType="com.spring.dto.Qna">
    SELECT * FROM (
        SELECT q.*, ROWNUM AS rnum 
        FROM qna q
        WHERE ROWNUM <= 5
        ORDER BY q.parno DESC, q.plevel ASC
    )
    WHERE rnum <= 5
  </select>
 -->
 
  <select id="getQna" parameterType="int" resultType="com.spring.dto.Qna"> 
    SELECT * FROM qna WHERE no = #{no} 
  </select>

  <insert id="insertQna" parameterType="com.spring.dto.Qna">
    INSERT INTO qna (no, plevel, parno, title, content, resdate, visited, aid)
    VALUES (qseq.NEXTVAL, #{plevel}, #{parno}, #{title}, #{content}, DEFAULT, #{visited}, #{aid})
  </insert>

  <update id="updateParnoForQna" parameterType="int">
    UPDATE qna SET parno = #{no} WHERE no = #{no}
  </update>

  <update id="updateQna" parameterType="com.spring.dto.Qna">
    UPDATE qna
    SET title = #{title}, content = #{content}, aid = #{aid}
    WHERE no = #{no}
  </update>

  <delete id="deleteQna" parameterType="int">
    DELETE FROM qna WHERE no = #{no}
  </delete>

</mapper>

<!-- 해당 요소의 id는 중복되어서도 안되며, 메소드 이름을 의미합니다. -->
<!-- 
·	private int no;
	private int plevel;
	private int parno;
	private String title;
	private String content;
	private String resdate;
	private int visited;
	private String aid;
	-->